# syntax=docker/dockerfile:latest

ARG UBUNTU_VERSION=24.04
FROM ubuntu:${UBUNTU_VERSION} AS base

COPY scripts/install_deps.sh /usr/local/bin/install_deps.sh
RUN --mount=type=cache,target=/var/cache/apt,sharing=locked \
    bash /usr/local/bin/install_deps.sh

####################################

FROM base

# Auto warpify for Warp Terminal (--build-arg WARPIFY=false to disable)
ARG WARPIFY=true
COPY scripts/warpify.sh /usr/local/bin/warpify.sh
RUN chmod +x /usr/local/bin/warpify.sh && \
    if [ "$WARPIFY" = "true" ]; then /usr/local/bin/warpify.sh; fi

WORKDIR /app
ENTRYPOINT ["tail", "-f", "/dev/null"]
